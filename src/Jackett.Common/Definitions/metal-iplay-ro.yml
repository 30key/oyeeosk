---
  site: metaliplayro
  name: metal.iplay.ro
  description: "Romanian Metal Torrent is a Semi-Private site dedicated to METAL MUSIC. This definition is for the English site."
  language: en-us
  type: semi-private
  encoding: UTF-8
  links:
    - http://metal.iplay.ro/

  caps:
    categories:
      "Music": Audio

    modes:
      search: [q]
      music-search: [q, album, artist, label, year]

  login:
    path: login.php
    method: form
    form: form[action="takelogin.php"]
    captcha:
      type: image
      selector: img
      input: vImageCodP
    inputs:
      username: "{{ .Config.username }}"
      password: "{{ .Config.password }}"
    error:
      - selector: div.errorSummary
        message:
          selector: div.errorSummary ul li
    test:
      path: browse.php
      selector: a[href="logout.php"]
      
  download:
    selector: a[href^="download2.php?id="]
    attribute: href
  
  search:
    paths:
      - path: browse.php
        method: get
    inputs:
      "search": "{{if .Query.Artist}}{{ .Query.Artist }}{{else}}{{ .Keywords }}{{end}}"
    rows:
      selector: table.torrents_table tbody tr
      filters: # optional list of row filter
        - name: andmatch # The andmatch filter will make sure that only torrents which
                         # contain all words from the search string are returned.
                         # This is helpful if the tracker returns a lot of unrelated
                         # search results.
          args: 66 # optional argument, the maximum length of the search string which 
                   # should be compared. Specify this if the trackers cuts of the
                   # torrent name after a certain amount of characters.
        - name: strdump # dump the HTML of each row to the log (for debugging purposes)
    fields:
      title:
        selector: td a[href^="details.php?id="]
      details:
        selector: td a[href^="details.php?id="]
        attribute: href
      download:
        selector: td a[href^="download2.php?id="]
        attribute: href
      banner: # link to a banner image (cover, etc.)
        optional: true # don't fail if the selector doesn't match
        selector: td:nth-child(2) a
        attribute: onmouseover
        filters:
          - name: regexp
            args: src=\\'(.+?)\\'
          - name: replace # replace dummy image with empty string
            args: ["./pic/noposter.jpg", ""]
      date:
        selector: td:nth-child(8) > span
        attribute: title
      size:
        selector: td:nth-child(6)
      seeders:
        selector: td:nth-child(7)
        filters:
          - name: regexp
            args: '([\d]+) seeders' # get the first number from the result
      leechers:
        selector: td:nth-child(7)
        filters:
          - name: regexp
            args: '([\d]+) leechers' # get the first number from the result
      grabs: # number of downloads
        selector: td:nth-child(6)
        filters:
          - name: regexp
            args: '([\d]+) times' # get the first number from the result
